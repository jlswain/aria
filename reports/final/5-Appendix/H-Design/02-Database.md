### H-2 Database {- #H-2}

#### Database Entity-Relationship {-}

![](./uml/SystemER.png)

#### Database Tables {-}

##### Request {-}

A request generated for a device. This request can be generated from the UI, the machine learning, 
or by an external user on the physical device. A row in the Request table is a requested state
change of a controllable device.

##### Event {-}

An event generated for the system. An event is a response to a request, changing the value of a 
device attribute based on the request. Events are linked to the Requests that cause them through the
request_id foreign key. They are also linked to devices through the source foreign key, which is the
device which caused the event. An event can also be generated by a non controllable sensor, in which
case it will not be linked to a Request.

##### Parameter_Change {-}

Holds the requested parameter to change or the parameter changed by an event, linked to by a foreign
key in the Request and Device tables. The parameter field is a foreign to the Parameter table.

##### Devices {-}

The individual devices connected to the system. Each device is uniquely identified by it's UUID, 
stored as the address. Each device has a device type, which can be used to determine what attributes
are available for a device of that type.

##### Device Types {-}

Specific manufacturer information for different types of possible devices (WeMo switch, Hue lights,
etc...). This table also holds what communication protocol is needed to communicate with a device 
type and if it is an input or not.  

##### Attributes {-}

An attribute is a field of a device that provides information about the current device state. A 
controllable attribute is one such as the colour of a smart light bulb, where as a non-controllable 
attribute would be one such as reading from a sensor. Attributes can have multiple parameters 
associated to them. Take a smart light bulb for example; the attribute would be the colour of the 
bulb, and the parameters could involve different possible colours such as red, blue, and blue.

##### Parameters {-}

Parameters are associated to an attribute. They are used to describe the possible states of 
their associated attribute.

##### Schedule_Change {-}

Used to enable device scheduling. A parameter is associated with a value to change to, and a link to
the schedule table. This link is used to determine when the requested parameter change should occur.

##### Schedule {-}

A schedule determines when a parameter should change. It allows for a scheduled event to be
recurring according to date, repeated for a set number of times, or simply occur once.


